## Face Recognition App

Python-приложение для распознавания лиц через веб-камеру в режиме реального времени.
Проект демонстрирует использование архитектурного паттерна **MVC** и принципов **SOLID**.

### Описание проекта

- **Захват видео**: поток с веб-камеры в реальном времени (OpenCV).
- **Обнаружение лиц**: `face_recognition.face_locations` с даунскейлом кадра.
- **Распознавание**: сравнение эмбеддингов лиц с базой известных лиц.
- **Визуализация**: рамки вокруг лиц, имя или `Unknown`, и **confidence score**.

### Системные требования

- **Python**: 3.9–3.11
- **OS**: Windows / Linux / macOS
- Установленная система работы с веб-камерой (драйверы, доступ к камере)

### Быстрый старт

1. Клонируйте репозиторий и перейдите в корневую директорию проекта.
2. Перейдите в папку `face_recognition_app`.
3. Установите зависимости:
   - **Windows**: `scripts\install_dependencies.ps1`
   - **Linux/Mac**: `bash scripts/install_dependencies.sh`
4. Запустите приложение:
   - **Windows**: `scripts\run_app.ps1`
   - **Linux/Mac**: `bash scripts/run_app.sh`

Откроется окно с видеопотоком. Нажмите `q` или `Esc`, чтобы завершить работу.

### Установка и настройка

- Все зависимости перечислены в `requirements.txt`.
- Базовая конфигурация приложения хранится в `app/utils/config.py`:
  - **video**: индекс камеры, ширина/высота кадра, целевой FPS, заголовок окна.
  - **face**: пути к данным (`data/known_faces`, `data/models`), параметры детекции и толеранс распознавания.
- При необходимости можно использовать `pyproject.toml` для интеграции в другие инструменты (Poetry, IDE и т.п.).

### Использование

- При запуске приложение:
  - Читает кадры с камеры.
  - Обнаруживает лица на каждом кадре.
  - Распознаёт лица по базе известных лиц.
  - Отображает рамки, имена и confidence score, а также текущий FPS.

### Добавление новых лиц

1. Перейдите в `data/known_faces/`.
2. Создайте подпапку с именем человека, например: `data/known_faces/Ivan/`.
3. Поместите в эту папку одно или несколько фото лица в формате `.jpg`, где лицо хорошо видно.
4. Перезапустите приложение — при старте `SimpleFaceRecognizer` пересканирует директорию и обновит базу эмбеддингов.

Рекомендации:

- Используйте фотографии в анфас, с хорошим освещением.
- Можно добавить несколько фотографий одного человека с разными ракурсами для повышения точности.

### Решение проблем

- **Камера не открывается**:
  - Проверьте значение `camera_index` в `app/utils/config.py` (0, 1, 2, ...).
  - Убедитесь, что камера не занята другим приложением.
- **Нет распознавания, все лица `Unknown`**:
  - Убедитесь, что структура `data/known_faces` корректна и там есть `.jpg` файлы.
  - Проверьте освещение и качество видео.
  - Попробуйте уменьшить `recognition_tolerance` (значения ближе к 0.5–0.55 делают проверку строже).
- **Производительность ниже 25 FPS**:
  - Уменьшите `detection_scale_factor` (например, до 0.2) в `config.py` для ускорения.
  - Закройте лишние приложения, использующие CPU/GPU.

### Технические детали

- **Архитектура**:
  - `app/models/` — **Model**:
    - `camera_model.py`: захват кадра (абстракция камеры).
    - `face_detector.py`: обнаружение лиц (детектор).
    - `face_recognizer.py`: распознавание лиц, работа с эмбеддингами и базой известных лиц.
  - `app/views/` — **View**:
    - `video_view.py`: отрисовка кадров, рамок, подписей, FPS (OpenCV GUI).
    - `main_view.py`: композиция вью, точка расширения для более сложного UI.
  - `app/controllers/` — **Controller**:
    - `camera_controller.py`: управление источником видео.
    - `face_controller.py`: координация детектора и распознавателя, подготовка данных для отображения.
  - `app/main.py` — связывает все компоненты и запускает главный цикл.

- **SOLID**:
  - **SRP**: каждый класс отвечает за одну зону ответственности (камера, детекция, распознавание, UI, конфиг и т.п.).
  - **OCP**: можно добавлять новые реализации детектора или распознавателя, не меняя контроллеры (через интерфейсы/абстракции).
  - **LSP**: любые реализации интерфейсов (например, `CameraInterface`, `FaceDetectorInterface`, `FaceRecognizerInterface`) могут подставляться в контроллеры без изменения их логики.
  - **ISP**: контроллеры зависят от узкоспециализированных интерфейсов, а не от «толстых» классов с лишними методами.
  - **DIP**: основные зависимости передаются извне (в конструкторы контроллеров), код зависит от абстракций, а не от конкретных реализаций.

### Разработка

- Тесты:
  - Базовый пример теста: `tests/test_config.py`.
  - Рекомендуется добавить:
    - Тесты для загрузки и распознавания лиц (моки/фикстуры).
    - Тесты для контроллеров (проверка координации слоёв).
- Логирование:
  - Используется `loguru`, лог по умолчанию пишется в `face_recognition_app.log`.
  - Точка входа: `app/main.py`.

Face Recognition App
=====================

Python-приложение для распознавания лиц в режиме реального времени с веб-камеры.
Проект демонстрирует использование архитектурного паттерна MVC и принципов SOLID.


